async function buildHTML() {
  const title = document.getElementById('title').value || 'New Situation';

  // Gather all step titles and details
  const steps = [];
  for (let i = 1; i <= 5; i++) {
    steps.push({
      text:   document.getElementById(`step${i}`).value   || `Step ${i}`,
      detail: document.getElementById(`detail${i}`).value || ''
    });
  }

  // Start HTML
  let html = `<!DOCTYPE html>
<html lang="en">
<head>
  <link href="../global.css" rel="stylesheet">
  <meta charset="UTF-8">
  <title>${title}</title>
  <!-- PWA: Manifest & Theme -->
  <link rel="manifest" href="../manifest.json">
  <meta name="theme-color" content="#ffffff">
  <link rel="icon" href="../leaf.png">
  <!-- Service Worker Registration -->
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('../service-worker.js');
      });
    }
  </script>
</head>
<body>

  <!-- LEAF HEADER -->
  <header class="site-header">
    <img src="../leaf.png" class="site-logo" alt="Leaf Logo">
    <h1 class="site-title">${title}</h1>
  </header>

  <!-- BACK LINK -->
  <div class="back-menu">
    <a href="index.html">&larr; Back to Econa Menu</a>
  </div>

  <!-- FLOW (anchor list) -->
  <div class="flow">
${steps.map((s, idx) => `    <a href="#section${idx+1}">${s.text}</a>`).join('\n')}
  </div>

  <!-- SECTIONS -->
${steps.map((s, idx) => `  <section id="section${idx+1}">
    <h2>${idx+1}. ${s.text}</h2>
    <p>${s.detail}</p>
  </section>`).join('\n')}

  <!-- BACK LINK AGAIN -->
  <div class="back-menu">
    <a href="index.html">&larr; Back to Econa Menu</a>
  </div>

</body>
</html>`;

  return html;
}
